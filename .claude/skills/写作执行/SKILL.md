---
name: writing-executor
description: 执行实际的文章写作。基于已确认的需求和风格，采用反AI格式技巧，分步输出草稿。强调"写的时候就像人话"，而不是事后修补。
---

# 写作执行 (Writing Executor)

## 指令 (Instructions)

当写作需求已澄清、风格已确定后，进入实际写作阶段。本Skill的核心目标是：**从一开始就写出人话，而不是写完再去AI味**。

### 1. 写作前检查清单
在动笔前，必须确认以下信息已就绪：
- [ ] 写作需求已通过 `writing-clarifier` 确认
- [ ] **目标字数已明确**（如：2000字、3000字）
- [ ] 如有指定风格，已读取 `.claude/styles/[风格名].md` 中的"反AI格式特征"
- [ ] 如有调研素材，已从 `research-expert` 获取关键数据/案例

### 2. 信息交接（必须显式输出！）

**在开始写作前，必须先输出以下信息汇总，确保从前面步骤获取的所有信息已就绪：**

```
═══════════════════════════════════════════════════
📋 写作信息汇总
═══════════════════════════════════════════════════

【来自"澄清写作需求"】
• 主题：[主题名称]
• 切入方向：[具体方向描述]
• 目标受众：[受众描述]
• 文章类型：[观点文/分析文/指南/叙事]
• 目标字数：[X] 字
• 核心目的：[读者看完应该...]

【来自"风格文件"】
• 风格名称：[风格名]
• 核心人格：[一句话描述]
• 论证结构：[如：现象→质疑→反转→结论]
• 招牌动作：[列出3-5个]
• 禁用词汇：[列出主要禁用词]
• 格式规范：[小标题/加粗/列表的使用规则]

【来自"调研资料"】（如无调研则写"无"）
• 硬核数据：
  1. [数据1 + 来源]
  2. [数据2 + 来源]
• 典型案例：
  1. [案例1简述]
  2. [案例2简述]
• 可引用观点：
  1. [观点1 + 出处]

═══════════════════════════════════════════════════
```

**只有用户确认以上信息无误后，才能开始写作。**

如果某项信息缺失（如：没有做调研），需要：
1. 明确告知用户该项为空
2. 询问是否需要补充，还是直接开始写

### 3. 字数控制（必须严格执行！）

**字数误差必须控制在±20%以内。** 目标2000字，最终成稿必须在1600-2400字之间。差一倍是不可接受的。

#### 3.1 写作前的字数规划
根据目标字数，**严格规划结构并遵守**：

| 目标字数 | 开头 | 主体段落数 | 每段平均 | 结尾 | 允许范围 |
|---------|------|-----------|---------|------|---------|
| 1000字 | ~100字 | 4-5段 | ~150字 | ~100字 | 800-1200字 |
| 1500字 | ~150字 | 6-7段 | ~170字 | ~100字 | 1200-1800字 |
| 2000字 | ~200字 | 8-9段 | ~180字 | ~100字 | 1600-2400字 |
| 2500字 | ~250字 | 10-11段 | ~180字 | ~150字 | 2000-3000字 |
| 3000字 | ~300字 | 12-14段 | ~180字 | ~150字 | 2400-3600字 |

**动笔前必须告知用户：**
> "目标字数2000字（允许范围1600-2400字），我的规划是：开头约200字，主体8-9段（每段约180字），结尾约100字。"

#### 3.2 关键节点字数检查（防止严重超标！）

**必须在以下3个节点进行字数检查：**

| 节点 | 时机 | 预期进度 | 操作 |
|------|------|---------|------|
| 检查点1 | 开头写完后 | 约10% | 确认开头没有过长 |
| 检查点2 | 主体写到一半时 | 约50% | 如果已超50%，开始精简后续内容 |
| 检查点3 | 主体写到80%时 | 约80% | 如果已超80%，立即进入收尾 |

**字数统计方法（必须使用工具，禁止估算！）：**

由于模型无法准确估算中文字数，**必须使用以下方法获取真实字数**：

1. **把已写内容保存到临时文件**：
   ```
   使用 write_to_file 工具保存到：
   articles/temp_count.txt
   ```

2. **用命令统计实际字数**：
   ```powershell
   # Windows PowerShell
   (Get-Content articles/temp_count.txt -Raw).Length
   ```
   或
   ```bash
   # 如果有 wc 命令
   wc -m articles/temp_count.txt
   ```

3. **对比目标字数，决定下一步**

**检查点执行流程：**
```
写完开头/主体一半/主体80%
    ↓
保存到 temp_count.txt
    ↓
运行命令统计字数
    ↓
获取实际字数（如：2752字）
    ↓
对比目标（如：2000字）
    ↓
计算进度：2752/2000 = 137%（超标！）
    ↓
触发红线，立即停止
```

**如果检查点发现严重超标（超过预期进度20%以上）：**
- 立即停止当前段落
- 告知用户："【实际字数检查】当前已写XXX字，超出预期，建议立即收尾或删减内容"
- 等待用户指示

#### 3.3 硬性红线（绝对禁止突破！）

| 红线 | 触发条件 | 强制操作 |
|------|---------|---------|
| 黄线 | 实际字数达到目标的90% | 必须开始写结尾段 |
| 红线 | 实际字数达到目标的110% | 立即停止，不再输出新内容 |
| 死线 | 实际字数达到目标的120% | 这是失败，需要删减重写 |

**示例：** 目标2000字
- 写到1800字 → 黄线预警，开始收尾
- 写到2200字 → 红线触发，立即停止
- 写到2400字 → 已到允许上限，必须结束
- 写到2500字以上 → 失败，需要删减

#### 3.4 字数不足时的补救
如果写到结尾发现字数不足（低于目标80%）：
- ❌ 禁止：硬凑废话、重复已说过的观点
- ✅ 推荐：
  - 增加一个具体案例或场景描写
  - 补充一个反向观点的讨论
  - 展开某个论点的细节

### 4. 反AI写作技巧（核心！）

**开头技巧（禁止AI套路）：**
- ❌ 禁止："在当今社会..."、"随着...的发展..."、"众所周知..."
- ✅ 推荐：直接抛出一个具体场景、一个尖锐问题、或一句有态度的判断
- ✅ 示范："你朋友圈里那些'深度好文'，有多少是真正原创的？"

**过渡技巧（禁止排比连接词）：**
- ❌ 禁止："首先...其次...再次...最后..."、"第一点...第二点..."
- ✅ 推荐：
  - 用反问句引出下一个话题（"那问题来了，为什么..."）
  - 直接切换，不做过渡（人说话经常跳跃）
  - 用短句做情绪转折（"说到这个，更气人的是..."）

**段落技巧（禁止格式洁癖）：**
- ❌ 禁止：每段都是3-5句，长度高度一致
- ✅ 推荐：
  - 有的段落只有一句话（制造节奏感）
  - 有的段落七八句话（信息密集区）
  - 长短交替，像呼吸一样

**小标题技巧（默认不用）：**
- ❌ 禁止：每隔两三段就来一个"## 小标题"
- ✅ 推荐：
  - 用一个独立短句做"隐形标题"（如："说回正题。"）
  - 用反问句切换话题（如："但你有没有想过..."）
  - 除非用户明确要求，否则不使用markdown格式的小标题

**结尾技巧（禁止假大空升华）：**
- ❌ 禁止："让我们共同期待..."、"总而言之..."、"综上所述..."
- ✅ 推荐：
  - 戛然而止（说完最后一个观点就停）
  - 留一个反问或悬念
  - 回扣开头的场景或问题

**词汇技巧（禁止AI腔）：**
- ❌ 禁止："赋能"、"抓手"、"底层逻辑"、"认知升级"、"降维打击"
- ✅ 推荐：用具体动作替代抽象概念（"认知升级"→"每周读一本书然后写笔记"）

### 5. 标题设计（必须在写作前完成！）

在开始写正文之前，必须先设计标题：

**设计3个候选标题：**
1. **吸引型标题**：用悬念、反问或惊人数据吸引点击
2. **信息型标题**：直接说明文章主旨，让读者知道会读到什么
3. **情绪型标题**：触动情绪，引发共鸣或好奇

**标题设计规则：**
- 禁止使用AI常见标题套路（如："深度解读XXX"、"全面分析XXX"、"你不知道的XXX"）
- 标题长度建议15-25字
- 如果使用了风格文件，标题也要符合该风格的语气

**示例输出：**
```
📝 请选择文章标题：

A.【吸引型】35岁程序员危机？醒醒吧，你被收割了
B.【信息型】Stack Overflow数据告诉你：35岁危机是个什么玩意儿
C.【情绪型】那些贩卖35岁焦虑的人，一年赚了你几辈子的钱

请选择 A/B/C，或告诉我您想要的标题方向：
```

**用户选择后，记录最终标题，后续保存文件时使用此标题。**

### 6. 分步起草流程（含字数追踪）

**第一步：开头段（必须单独确认）**
- 写出开头1-2段，发给用户确认
- 开头是全文的"第一印象"，必须通过用户的"AI检测直觉"
- 如果用户说"有点AI味"，立刻重写，不要解释
- **报告字数**：`【开头段：XXX 字 / 目标 XXXX 字，完成 XX%】`

**第二步：主体段落（分批输出+字数追踪）**
- 每次输出2-3个自然段
- 保持段落长度的不规则性
- **每批必须报告累计字数**：`【当前进度：已写 XXX 字 / 目标 XXXX 字，完成 XX%】`
- 根据进度决定后续内容的详略
- 如果进度过快（内容还没说完但字数快到了），提前告知用户

**第三步：收尾段**
- 不要硬凑总结
- 如果观点已经说完，直接停
- 让用户确认是否需要调整收尾方式
- **最终报告**：`【全文完成：共 XXX 字，目标 XXXX 字，达成率 XX%】`

### 7. 风格执行（读取深度风格文件）

如果用户指定了风格文件（如 `墨水怪风.md`），必须**完整读取并严格执行**该文件的所有维度：

**必须执行的核心配方：**
1. **核心人格**：按照文件中定义的人设、态度、价值观来写
2. **思维模式**：遵循文件中的论证结构（如"现象→质疑→反转→结论"）
3. **开头配方**：使用文件中定义的开头句式，参考示范
4. **过渡配方**：使用文件中的替代词，禁用文件中的禁用词
5. **招牌动作**：每篇文章必须使用至少3个文件中定义的招牌动作
6. **段落模板**：写作时参考文件中的段落模板库

**写作中的自检：**
- 每写完一段，对照风格文件检查
- 重点检查：是否使用了招牌动作？是否符合句式配方？
- 如发现偏离，立刻修正

### 8. 版本管理与文件保存（必须执行！）

文章的每个版本都必须保存为独立的 `.md` 文件，存放在 `articles/` 目录下（如不存在则创建）。

**文件命名规则：**
```
[标题]_[版本号]稿.md
```

**版本类型：**
| 版本 | 文件名示例 | 说明 |
|------|-----------|------|
| 初稿 | `35岁程序员危机_1稿.md` | 第一次完成的完整草稿 |
| 修订稿 | `35岁程序员危机_2稿.md` | 根据审稿意见修改后的版本 |
| 再修订 | `35岁程序员危机_3稿.md` | 继续修改的版本 |
| 最终稿 | `35岁程序员危机_最终稿.md` | 用户确认通过的最终版本 |

**保存时机：**
1. **初稿完成后**：立即保存为 `[标题]_1稿.md`
2. **每次修改后**：保存为 `[标题]_N稿.md`（N递增）
3. **用户确认最终版**：保存为 `[标题]_最终稿.md`

**文件内容格式：**
```markdown
# [标题]

> 版本：[N]稿
> 字数：[XXX] 字
> 风格：[风格名]
> 创建时间：[YYYY-MM-DD HH:MM]

---

[正文内容]
```

**保存后必须告知用户：**
```
📁 已保存：articles/35岁程序员危机_1稿.md（共 1987 字）
```

## 示例 (Examples)

**用户：** 开始写吧，按墨水怪风格。

**AI：**
好的，我已完整读取 `墨水怪风.md` 的深度风格配方。根据该风格，我将执行：

**核心人格**：愤世嫉俗但真诚的老朋友，深夜喝酒聊天的语气
**论证结构**：流行观点 → 质疑 → 反转 → 反常识结论
**招牌动作**：悖论翻转、自问自答、口语化超长句、情绪短句收尾、骂读者
**格式**：无小标题、无加粗、无列表

现在先输出开头段（使用"反问开头"配方），请您确认是否像墨水怪：

---

你朋友圈里那些"深度好文"、"干货分享"，有多少是真正原创的？

真相会让你恶心。新榜2023年的数据摆在那里，微信热文里三成都是洗稿，每三篇爆文就有一篇是偷来的。更气人的是什么？这帮小偷靠着偷来的内容年入百万，原创作者呢？可能在吃泡面。你说这他妈公平吗？

---

这个开头用了"反问开头"+"自问自答"两个招牌动作。您觉得像墨水怪吗？还是哪里需要调整？

## 最佳实践 (Best Practices)
- **字数必须用工具统计：** 禁止估算！必须保存文件后用命令统计实际字数。
- **字数红线不可突破：** 超过目标110%立即停止，超过120%视为失败需要删减。
- **关键节点必须检查：** 开头完成、主体50%、主体80%三个节点必须用工具核对字数。
- **标题先行：** 先设计3个候选标题让用户选择，再开始写正文。
- **版本必须保存：** 每完成一个版本（初稿/修订稿/最终稿）必须保存为独立文件。
- **信息交接必须显式输出：** 开始写作前必须输出信息汇总表，确认所有输入都已就绪。
- **完整读取风格文件：** 不要只读"风格画像"，要读完所有12个维度，尤其是"招牌动作"和"段落模板"。
- **招牌动作决定灵魂：** 风格辨识度80%来自招牌动作，每篇必须用3个以上。
- **开头决定生死：** 如果开头就有AI味，后面写得再好也没用。

## 版本记录 (Version History)
- v1.6.0 (2025-12-21): 强制使用外部工具统计字数，禁止模型估算。通过文件保存+命令统计获取真实字数。
- v1.5.0 (2025-12-21): 强化字数控制，新增关键节点检查、黄线/红线/死线机制，确保误差±20%以内。
- v1.4.0 (2025-12-21): 新增"标题设计"模块（3选1）和"版本管理与文件保存"模块。
- v1.3.0 (2025-12-21): 新增"信息交接"模块，要求显式输出从前面步骤获取的所有信息。
- v1.2.0 (2025-12-20): 新增字数控制模块，包括写作前规划、写作中追踪、字数不足/超出的处理。
- v1.1.0 (2025-12-20): 更新风格执行逻辑，支持读取12维度深度风格文件。
- v1.0.0 (2025-12-20): 初始版本，聚焦反AI写作技巧和分步起草流程。
