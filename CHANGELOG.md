# Changelog

All notable changes to 写稿Agent will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.3.1] - 2026-01-06

### Added
- 🚀 **风格建模闭环工作流**：
  - **URL 一键提取**：`style-modeler` 现在直接支持 URL 输入，自动调用 `web-article-extractor` 抓取正文。
  - **公众号自动处理**：针对微信公众号链接，自动应用绕过安全限制的配置。
  - **批量串行提取**：支持一次性投喂多篇 URL，自动构建“超级样本”进行整体分析。
  - **增量更新机制**：自动识别同作者，支持将新文章融合到现有风格文件中，迭代进化。
  - **自动归档**：提取的原始文章会自动保存为 Markdown 到 `docs/` 目录，建立本地素材库。
## [0.3.0] - 2026-01-04

### Added
- 🚀 **爆款能力全面升级**：
  - **核心思路转变**：从"写得好"（文笔流畅）转向"写对了"（读者痛点/爆款传播）。
  - **选题调研 Skill**（`topic-research`）：
    - 写作前的第一步，防止自嗨。
    - 4步调研法：热点扫描 → 爆款拆解 → 痛点验证 → 选题打分。
  - **发布前评审 Skill**（`pre-publish-review`）：
    - 写作后的最后一步，质量最后一道防线。
    - "发布前5问"清单：标题、开头、认同、出路、转发价值。
    - 评分低于一定标准强烈建议重写。

- ⚡ **核心 Skill 增强**：
  - **标题设计师**（`title-designer`）：
    - 新增5种爆款标题公式库（数字具体化、对立冲突、身份认同、悬念反转、情绪宣泄）。
    - 新增标题自检清单（3秒法则、具体化检查）。
  - **写作执行**（`writing-executor`）：
    - 新增"开头钩子"强制模块（4种钩子类型：场景代入、身份捆绑、悬念打开、情绪共振）。
    - 强制"前50字生死线"检查。
  - **共情点设计师**（`empathy-designer`）：
    - 强化开头50字的共情设计权重。

- 🎨 **风格与资源升级**：
  - **风格文件增强**：
    - `墨水怪风.md` 和 `jiubian.md` 新增"目标读者画像"维度（第16节）。
    - 包含精准画像、阅读场景、核心需求、禁忌雷区。
  - **案例库框架**：
    - 创建 `articles/_case_library/` 目录结构。
    - 提供三大类案例模板：职场故事、认知反转、情绪共鸣。

### Changed
- 🔄 **写作工作流优化**：
  - 新增"Stage 0: 选题调研"（动笔前先验证）。
  - 新增"Stage 8: 发布前把关"（发布前先评审）。
  - 标题设计和开头设计权重大幅提升。



### Added
- ✨ **协作写作工作流系统**：
  - 新增 `workflow-producer`（工作流导演）作为所有写作请求的唯一入口
  - 强制模式选择：轻量模式 vs 协作模式（8阶段）
  - 8阶段完整 SOP：主题校准 → 调研 → 大纲 → 共情 → 具象化 → 标题设计 → 创作 → 审稿
  - 每阶段完成后显示进度条和产物保存路径
  
- ✨ **标题设计师 Skill**（`title-designer`）：
  - 独立的标题设计环节（Stage 5.5）
  - 设计3种候选标题：吸引型/信息型/情绪型
  - 禁止 AI 套路标题（如"深度解读XXX"）
  - 用户确认后才能进入正式写作
  
- ✨ **风格建模系统升级至 v3.0**：
  - **12维度 → 15维度深度解构框架**
  - 新增维度：
    - 作者画像与核心人格（基础特征、知识结构、经历痕迹）
    - 思维内核与论证逻辑（核心世界观、价值判断、分析模式）
    - 创作路径还原（痛点捕捉、共情设计、出路探索）
    - 互动设计（读者预设、互动技巧、引导策略）
  - 扩展维度：
    - 词汇指纹（5类细分：口语连接词、高频动词、程度副词、情感词汇、网络流行语）
    - 招牌动作（5类细分：悖论翻转、质疑打断、情绪短句、自问自答、务实建议）
    
- ✨ **新增风格配方**：
  - **九边风**（`jiubian.md`）：职场老炮式人生导师
    - 招牌动作："那问题来了"、案例故事化、承认局限
    - 分析模式：现象→机制→人性→出路
  - **墨水怪风**（`墨水怪风.md`）更新：基于新样本重新解构
    - 招牌动作：悖论翻转、质疑打断、真诚骂人
    - 特色词汇：兽性、进化心理学、巴甫洛夫
    
- 📚 **新增协作 Skills**：
  - `outline-architect`（大纲架构师）
  - `empathy-designer`（共情点设计师）
  - `concretizer`（具象化专家）
  
- 📖 **新增文档**：
  - `docs/WORKFLOW_QUICK_REFERENCE.md`（协作写作工作流快速参考）
  - `docs/SKILLS_UPDATE_SUMMARY.md`（Skills 更新总结）
  - `docs/jiubiancank.md`（九边风格分析参考）
  - `docs/墨水怪.md`（墨水怪风格样本）

### Changed
- 🔧 **子 Skill 权限调整**：
  - 将 `writing-clarifier`、`writing-executor` 等标记为 `INTERNAL UTILITY ONLY`
  - 防止跳过工作流导演直接调用
  - 所有写作请求必须经过 `workflow-producer` 统一调度
  
- 🔧 **标题设计流程优化**：
  - 从 `writing-executor` 的第5步提升至第2.5步
  - 在信息汇总确认后立即设计标题
  - 用户确认标题后才能进入字数规划和正式写作
  
- 🔧 **风格检查防幻觉**：
  - 强制使用 `list_dir` 工具检查 `.claude/styles/` 目录
  - 禁止 AI 编造不存在的风格名称
  - 只能列出工具返回的真实文件名

### Fixed
- 🐛 修复风格建模可能跳过标题设计的问题
- 🐛 修复 AI 可能编造不存在风格的问题
- 🐛 修复协作模式下可能跳过某些阶段的问题

---

## [0.1.0] - 2025-12-21

### Added
- 🎉 **首次公开发布**
- **5个核心 Skills**：
  - `writing-clarifier`（写作需求澄清 v1.3.0）
  - `research-expert`（调研资料 v1.0.0）
  - `style-modeler`（风格建模 v2.0.0）
  - `writing-executor`（写作执行 v1.6.0）
  - `editor-review`（主编审稿 v1.1.0）
- **反AI味道系统**：
  - 自动去除小标题病、排比上瘾、格式洁癖等AI典型特征
  - 默认启用反AI格式，无需每次确认
- **风格建模系统**：
  - 12维度深度解构
  - 招牌动作提取
  - 段落模板库
  - 示例风格：墨水怪风（173行完整配方）
- **字数精准控制**：
  - 强制外部工具统计（误差±20%以内）
  - 关键节点检查机制（开头/主体50%/主体80%）
  - 黄线/红线/死线机制
- **版本管理**：
  - 自动保存初稿、修订稿、最终稿
  - 文件命名规则：`[标题]_[版本号]稿.md`
- **标题设计模块**：
  - 3个候选标题（吸引型/信息型/情绪型）
- **信息交接模块**：
  - 写作前显式输出信息汇总表
- **工作流完整性**：
  - 强制询问是否需要调研
  - 防止跳过关键步骤
- **DeepSeek API 支持**：
  - 完美兼容 Anthropic API
  - 成本极低（一篇2000字文章约¥0.03）
  - 详细配置文档

### Documentation
- 完整的 README.md（中文）
- CHANGELOG.md（版本历史）
- CONTRIBUTING.md（贡献指南）
- LICENSE（MIT）
- docs/FAQ.md（24个常见问题）
- docs/DEEPSEEK_SETUP.md（DeepSeek配置指南）
- docs/PROJECT_STRUCTURE.md（项目结构说明）

---

## 版本号说明

- **Major (X.0.0)**: 重大架构变更或不兼容更新
- **Minor (0.X.0)**: 新功能添加
- **Patch (0.0.X)**: Bug 修复和小优化
